<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>로그인 성공</title>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('jwtToken');
      if (!token) {
        alert('로그인이 필요합니다.');
        window.location.href = '/users/login';
      } else {
        fetch('/wishlist', {
          method: 'GET',
          headers: {
            'Authorization': 'Bearer ' + token,
            'Content-Type': 'application/json'
          }
        })
        .then(response => {
          if (response.status === 401) {
            alert('인증 실패: 토큰이 유효하지 않거나 만료되었습니다.');
            window.location.href = '/users/login';
          } else {
            return response.text();
          }
        })
        .then(html => {
          document.body.innerHTML = html;
        })
        .catch(error => console.error('Error:', error));
      }
    });
  </script>
</head>
<body>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const token = document.getElementById('token-text').innerText;
    if (token && token !== 'DEFAULT_TOKEN') {
      localStorage.setItem('jwtToken', token);
      alert('토큰이 저장되었습니다.');
    } else {
      alert('토큰을 저장하는 데 실패했습니다.');
    }
  });
</script>
</body>
</html>